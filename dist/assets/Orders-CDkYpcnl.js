import{r as n,j as e,L as o}from"./vendor.react-CkiSaVqk.js";import{a as m,b as u}from"./index-Cj4xjNz1.js";import"./vendor-BUQXJReI.js";function g(){const{user:t,loading:c}=m(),[d,a]=n.useState([]),[h,i]=n.useState(!0);return n.useEffect(()=>{if(!t){a([]),i(!1);return}if(c){i(!0);return}let s=!1;return(async()=>{try{const r=await u.currentUser.getIdToken(),l=await fetch("/api/orders",{headers:{Authorization:`Bearer ${r}`}});if(!l.ok)throw new Error("Failed to fetch orders");const x=await l.json();if(s)return;a(x.orders||[])}catch(r){console.error("Failed to fetch orders",r)}finally{s||i(!1)}})(),()=>{s=!0}},[t]),t?e.jsx("section",{style:{padding:40},children:e.jsxs("div",{className:"container",style:{maxWidth:920},children:[e.jsx("h2",{children:"My Orders"}),h?e.jsx("div",{className:"loading",children:"Loading…"}):d.length===0?e.jsxs("div",{className:"empty-cart",style:{padding:40},children:[e.jsx("p",{children:"No orders yet. Start shopping!"}),e.jsx(o,{to:"/",className:"buy-button",children:"Browse products"})]}):e.jsx("div",{className:"orders-list",children:d.map(s=>e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Order:"})," ",s.razorpay_order_id||s.order_id||s.id]}),e.jsxs("div",{children:["₹",(s.amount/100).toLocaleString()]})]}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("small",{children:["Payment id: ",s.razorpay_payment_id]})}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("strong",{children:"Items"}),e.jsx("ul",{children:(s.items||[]).map(r=>e.jsxs("li",{children:[r.name," × ",r.qty," — ₹",(r.price*r.qty).toLocaleString()]},r.id))})]})]},s.id))})]})}):e.jsx("section",{style:{padding:40},children:e.jsxs("div",{className:"container",style:{maxWidth:720},children:[e.jsx("h2",{children:"My Orders"}),e.jsxs("p",{children:["Please ",e.jsx(o,{to:"/login",children:"log in"})," to see your orders."]})]})})}export{g as default};
